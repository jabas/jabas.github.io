function getAverageColourAsRGB(a,e){var t=new ColorThief,r=t.getColor(a,1,e),n=t.getPalette(a,8,1,e),l={r:r[0],g:r[1],b:r[2]};return l.css="rgb("+l.r+","+l.g+","+l.b+")",l.palette=n,l}function getLuminance(a){for(var e=0;e<a.length;e++)a[e]<=.03928?a[e]=a[e]/12.92:a[e]=Math.pow((a[e]+.055)/1.055,2.4);var t=.2126*a[0]+.7152*a[1]+.0722*a[2];return t}function wcag1(){var a=125,e=500,t=(299*br.value+587*bg.value+114*bb.value)/1e3,r=(299*fr.value+587*fg.value+114*fb.value)/1e3,n=Math.abs(t-r),l=Math.max(fr.value,br.value)-Math.min(fr.value,br.value)+(Math.max(fg.value,bg.value)-Math.min(fg.value,bg.value))+(Math.max(fb.value,bb.value)-Math.min(fb.value,bb.value));document.getElementById("bDiff").value=n,document.getElementById("cDiff").value=l,n>=a&&l>=e?document.getElementById("cResult").value="YES":n>=a||l>=e?document.getElementById("cResult").value="sort of...":document.getElementById("cResult").value="NO"}function getAcessibility(a,e){var t=1,r=getLuminance([a.r/255,a.g/255,a.b/255]),n=getLuminance([e.r/255,e.g/255,e.b/255]);t=r>=n?(r+.05)/(n+.05):(n+.05)/(r+.05),t=Math.round(100*t)/100;var l=t>=4.5?"Passed":"Failed",i=t>=3?"Passed":"Failed",s=t>=7?"Passed":"Failed",o=t>=4.5?"Passed":"Failed";return{aa:l,aaPlus:i,aaa:s,aaaPlus:o}}!function(a,e,t){"use strict";var r=r||{};r=function(){function t(){h={aaArr:{passed:0,failed:0},aaPlusArr:{passed:0,failed:0},aaaArr:{passed:0,failed:0},aaaPlusArr:{passed:0,failed:0}}}function r(){t();var a=f(e("[data-js-color]"));u(a)}function n(){var t=e("[data-text-drag-frame]");t.draggable({containment:"parent",scroll:!1,stop:function(){e(a).trigger("draggable:stopped")}})}function l(){var a=e("[data-textarea]"),t=e("[data-picture-frame]"),r=a.width(),n=a.height(),l=a.offset(),i=t.offset(),s=l.left-i.left,o=l.top-i.top;return{w:r,h:n,x:s,y:o}}function i(){var a=e("[data-textarea]"),t=a.css("color"),r=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return delete r[0],{r:parseInt(r[1]),g:parseInt(r[2]),b:parseInt(r[3])}}function s(a){var e=h[a].passed+h[a].failed,t=h[a].passed/e*100;return t}function o(a){e("[data-label]").css({color:"#"+a})}function u(a){var t=e("[data-main-image]"),r=l(),n=getAverageColourAsRGB(t.get(0),r);c(n.palette),p(getAcessibility(i(),n),n),d(n.palette),o(a)}function d(t){var r=e("[data-accessibility-palette-overall]");r.html("");var n=[],l=Object.keys(t).length;for(var i in h){var o=h[i].passed-1>=l?"passed":"failed",u=s(i),d=u>=65&&u<100?"--nearly":g(o);n.push({type:i,state:o,perc:u,stateModifier:d})}var c=a.a11y.templates["palette-table"];r.append(c({color:"transparent",indicator:n,headerVisible:!0}))}function c(t){var r=e("[data-palette-container]"),n=i();r.html("");for(var l=0;l<t.length;l++){var s="rgb("+t[l][0]+","+t[l][1]+","+t[l][2]+")",o=getAcessibility(n,{r:t[l][0],g:t[l][1],b:t[l][2]}),u=[];for(var d in o)u.push({type:d,state:o[d],stateModifier:g(o[d])}),h[d+"Arr"][o[d].toLowerCase()]++;var c=a.a11y.templates["palette-table"];r.append(c({color:s,indicator:u}))}}function f(a){var t=e(a),r=t.val();return r}function v(a){var t=new FileReader(a);t.onload=function(a){new Image;e("[data-main-image]").get(0).src=a.target.result,r()},t.readAsDataURL(a.target.files[0])}function g(a){return"passed"===a.toLowerCase()?"--is-valid":"--is-invalid"}function p(t,r){var n=e("[data-accessibility-palette]");n.html("");var l=[];for(var i in t)l.push({type:i,state:t[i],stateModifier:g(t[i])}),h[i+"Arr"][t[i].toLowerCase()]++;var s=a.a11y.templates["palette-table"];n.append(s({color:r.css,indicator:l,headerVisible:!0}))}function b(a){var t=e(a.currentTarget).val();e("[data-textarea]").css({"font-size":t+"px"}),r()}function m(){e(a).on("draggable:stopped",r),e("[data-js-color]").on("change",r),e("[data-image-uploader-file]").on("change",v),e("[data-font-size]").on("change",b),r(),n()}var h={};m()},e(a).on("load",function(){new r})}(window,jQuery);